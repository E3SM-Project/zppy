[default]
input = /lcrc/group/e3sm2/ac.wlin/E3SMv3/v3.LR.historical_0101
output = /lcrc/group/e3sm/ac.szhang/acme_scratch/e3sm_project/zppy/zppy_pr719_output/unique_id_56/v3.LR.historical_0101
www = /lcrc/group/e3sm/public_html/diagnostic_output/ac.szhang/zppy_pr719_output/unique_id_56
campaign = "water_cycle"
case = v3.LR.historical_0101
debug = False
environment_commands = "source /lcrc/soft/climate/e3sm-unified/load_latest_e3sm_unified_chrysalis.sh"
#partition = debug #compute
partition = priority
account = priority

[ts]
active = True
walltime = "00:10:00"
years = "2005:2015:5"

  [[ atm_monthly_180x360_aave ]]
  input_subdir = "archive/atm/hist"
  input_files = "eam.h0"
  frequency = "monthly"
  mapping_file = /home/ac.zender/data/maps/map_ne30pg2_to_cmip6_180x360_aave.20200201.nc
  # list for pcmdi diag, note: PHIS,hyam,hybm,hyai,hybi need to be included to process the 3D fields
  vars = "ICEFRAC,LANDFRAC,OCNFRAC,PSL,FSNTC,FSNTOAC,SWCF,LWCF,FLUT,FSNT,FSNTOA,FLNT,FLNTC,FSNS,FLNS,FSNS,SHFLX,QFLX,LHFLX,TAUX,TAUY,PRECC,PRECL,PRECSC,PRECSL,TS,TREFHT,U10,QREFHT,TMQ,CLDTOT,CLDHGH,CLDMED,CLDLOW,FLDS,FSDS,TGCLDIWP,TGCLDCWP,TGCLDLWP,FLNSC,FLUTC,FSDSC,SOLIN,FSNSC,AODABS,AODVIS,AODDUST,AREL,TREFMNAV,TREFMXAV,PS,PHIS,U,V,T,Z3"

[e3sm_to_cmip]
active = True
frequency = "monthly"
ts_grid = "180x360_aave"
ts_num_years=5
walltime = "00:10:00"
years = "2005:2015:5"

  [[ atm_monthly_180x360_aave ]]
  # list of variables to be interpolated to pressure level; see e3sm_to_cmip/vrt_remap_plev19.nc
  # This defaults to cmip_plevdata = string(default="inclusions/e3sm_to_cmip/vrt_remap_plev19.nc")
  cmip_plevdata = /lcrc/group/e3sm/ac.szhang/acme_scratch/e3sm_project/zppy/zppy/templates/inclusions/e3sm_to_cmip/vrt_remap_plev19.nc
  input_files = "eam.h0"
  interp_vars = "U,V,T,Z3"
  ts_subsection = "atm_monthly_180x360_aave"
  vars = "ICEFRAC,LANDFRAC,OCNFRAC,PSL,FSNTC,FSNTOAC,SWCF,LWCF,FLUT,FSNT,FSNTOA,FLNT,FLNTC,FSNS,FLNS,FSNS,SHFLX,QFLX,LHFLX,TAUX,TAUY,PRECC,PRECL,PRECSC,PRECSL,TS,TREFHT,U10,QREFHT,TMQ,CLDTOT,CLDHGH,CLDMED,CLDLOW,FLDS,FSDS,TGCLDIWP,TGCLDCWP,TGCLDLWP,FLNSC,FLUTC,FSDSC,SOLIN,FSNSC,AODABS,AODVIS,AODDUST,AREL,TREFMNAV,TREFMXAV,PS,PHIS,U,V,T,Z3"

[pcmdi_diags]
active = True
environment_commands = "source /lcrc/soft/climate/e3sm-unified/load_latest_e3sm_unified_chrysalis.sh"
environment_commands_secondary = "source /lcrc/soft/climate/e3sm-unified/load_latest_e3sm_unified_chrysalis.sh; conda activate zi-pcmdi-diags-20250730"
nodes = 1
walltime = "4:00:00"
figure_format = "png"
run_type = "model_vs_obs"
# Create rules to construct cmip-like datasets with a string constructed as
# "mip.exp.product.realization", where "."is used as the delimiter (mandatory)
model_name = 'e3sm.historical.v3-LR.0101'
model_tableID = 'Amon'
multiprocessing = True
num_workers = 24
# Observational data
obs_ts = '/lcrc/soft/climate/e3sm_diags_data/obs_for_e3sm_diags/time-series'
pcmdi_debug = False
ts_years = "2005-2014",

  [[ mean_climate ]]
  active = True
  # Default for all variables or specify source for each variable separately.
  obs_sets = "default"
  ref_final_yr = 2018
  ref_start_yr = 1979
  ref_years = "2005-2014",
  # Variables in current pcmdi-cmip list
  # rltcre and rstcre are derived variables as they are not included in cmip_ts
  # define a new variable name to be flexible
  clim_vars = "pr,prw,psl,rlds,rldscs,rltcre,rstcre,rsus,rsuscs,rlus,rlut,rlutcs,rsds,rsdscs,rsdt,rsut,rsutcs,rtmt,sfcWind,tas,tauu,tauv,ts,ta-200,ta-850,ua-200,ua-850,va-200,va-850,zg-500"
  # See zppy/templates/pcmdi_diags/regions_specs.json for options of all regions
  # Below is default setup for global/regional mean climate metrics
  clim_regions = "global,ocean,land,Tropics,NHEX,SHEX"
  target_grid = "2.5x2.5"
  target_grid_string = "2p5x2p5"

  [[ variability_modes_cpl ]]
  active = True
  # See zppy/templates/pcmdi_diags/reference_alias.json for options
  obs_sets = "alternate1" #"default"
  ref_final_yr = 2019
  ref_start_yr = 1870
  ref_years = "2005-2014",
  movc_vars = "ts"
  movc_years = "2005-2014"
  # Name of modes varibility
  movc_modes = "PDO,NPGO,AMO"
  frequency = 'mo'
  landmask = True
  ModUnitsAdjust = '(True,"subtract",273.15)'
  ObsUnitsAdjust = '(True,"subtract",273.15)'
  seasons = "yearly,monthly"

  [[ variability_modes_atm ]]
  active = True
  # See zppy/templates/pcmdi_diags/reference_alias.json for options
  # Default for all variables
  obs_sets = "alternate2" # "default"
  ref_final_yr = 2015
  ref_start_yr = 1853
  ref_years = "2005-2014",
  mova_vars = "psl"
  mova_years = "2005-2014"
  # Varibility modes
  mova_modes = "NAM,NAO,PNA,NPO,SAM,PSA1,PSA2"
  frequency = 'mo'
  landmask = False
  ModUnitsAdjust = '(True,"divide",100.0)'
  ObsUnitsAdjust = '(True,"divide",100.0)'
  seasons = "DJF,MAM,JJA,SON,yearly,monthly"

  [[ enso ]]
  active = False
  # For enso, the obs_sets is explicitely set for each variable to ensure that
  # they are from the same source, below are setup to used ERA5 reanalysis.
  obs_sets = "default,alternate2,default,default,default,default,default,default,default,alternate2,alternate2,alternate2,alternate2,alternate2"
  ref_final_yr = 2018
  ref_start_yr = 1979
  ref_years = "2005-2014",
  enso_vars = "psl,pr,prsn,ts,tas,tauu,tauv,hfls,hfss,rlds,rsds,rlus,rlut,rsdt"
  enso_years = "2005-2014"
  # See zppy/templates/pcmdi_diags/reference_alias.json for options
  enso_groups = "ENSO_perf,ENSO_proc,ENSO_tel"

  [[ synthetic_plots ]]
  active = True

  # mean climate
  clim_viewer = True
  # use subset regions for viewer 
  clim_regions = "global,ocean,land"
  # use subset variables for viewer 
  clim_vars = "pr,prw,psl,rlds,rldscs,ua-200,zg-500"
  # period to be plotted and shown on webpage 
  # note that the previous sections allows multiple ts_years periods for processing, while 
  # the viewer page focused on period customized by user   
  clim_years = "2005-2014"

  # Location: /lcrc/group/e3sm/diagnostics/pcmdi_data/metrics_data/mean_climate/cmip6/historical
  cmip_clim_set = "cmip6.historical.v20250707"

  # modes variability (atmosphere)
  mova_viewer = True
  # use subset modes for viewer 
  mova_modes = "NAM,NAO,PNA,NPO,SAM"
  # period to be plotted and shown on webpage 
  # note that the previous sections allows multiple ts_years periods for processing, while 
  # the viewer page focused on period customized by user   
  mova_years = "2005-2014"

  # modes variability (coupled)
  movc_viewer = True
  # use subset modes for viewer 
  movc_modes  = "PDO,NPGO"
  # period to be plotted and shown on webpage 
  # note that the previous sections allows multiple ts_years periods for processing, while 
  # the viewer page focused on period customized by user   
  movc_years = "2005-2014"

  # Location: /lcrc/group/e3sm/diagnostics/pcmdi_data/metrics_data/variability_modes/cmip6/historical
  cmip_movs_set = "cmip6.historical.v20220825"
 
  # enso 
  enso_viewer = False
  enso_years = ""

  # Location: /lcrc/group/e3sm/diagnostics/pcmdi_data/metrics_data/enso_metric/cmip6/historical
  # There is no enso metric for CMIP6 AMIP, so use historical instead
  cmip_enso_set = "cmip6.historical.v20210620"
