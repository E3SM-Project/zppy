<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Adding a new set to the E3SM Diagnostics task &mdash; zppy  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Adding a new plot to Global Time Series" href="new_glb_plot.html" />
    <link rel="prev" title="Testing zppy for E3SM Unified release" href="tutorial_testing_e3sm_unified.html" />
    <link href="../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> zppy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Zppy documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../schematics.html">A schematic view of zppy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parameters.html">Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../campaigns.html">Campaigns</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="project-standards.html">Project Standards</a></li>
<li class="toctree-l2"><a class="reference internal" href="ci.html">Understanding CI</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">Testing zppy</a></li>
<li class="toctree-l2"><a class="reference internal" href="release_testing.html">Testing directions for making a release</a></li>
<li class="toctree-l2"><a class="reference internal" href="release.html">How to Prepare a Release</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorial_testing_e3sm_unified.html">Testing zppy for E3SM Unified release</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Adding a new set to the E3SM Diagnostics task</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-pull-requests">Example pull requests</a></li>
<li class="toctree-l3"><a class="reference internal" href="#handle-dependencies">Handle dependencies</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#add-dependencies-in-the-python-file">Add dependencies in the Python file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#update-the-climo-or-ts-bash-files">Update the <code class="docutils literal notranslate"><span class="pre">climo</span></code> or <code class="docutils literal notranslate"><span class="pre">ts</span></code> bash files</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-any-required-pre-processing-steps-to-the-bash-file">Add any required pre-processing steps to the bash file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#update-the-tutorial">Update the tutorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="#update-the-tests">Update the tests</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#add-the-new-set">Add the new set</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#add-new-set-to-defaults">Add new set to defaults</a></li>
<li class="toctree-l4"><a class="reference internal" href="#add-the-python-parameter-import-setup-to-the-bash-file">Add the Python parameter import/setup to the bash file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#explain-new-parameters">Explain new parameters</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id1">Update the tutorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id2">Update the tests</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="new_glb_plot.html">Adding a new plot to Global Time Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="new_task.html">Adding a new task</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to This Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">zppy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Developer Guide</a> &raquo;</li>
      <li>Adding a new set to the E3SM Diagnostics task</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/dev_guide/new_diags_set.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="adding-a-new-set-to-the-e3sm-diagnostics-task">
<h1>Adding a new set to the E3SM Diagnostics task<a class="headerlink" href="#adding-a-new-set-to-the-e3sm-diagnostics-task" title="Permalink to this heading"></a></h1>
<p>This guide gives a general list of things to consider when adding a new
E3SM Diagnostics set. The exact code changes required will differ amongst sets.</p>
<div class="section" id="example-pull-requests">
<h2>Example pull requests<a class="headerlink" href="#example-pull-requests" title="Permalink to this heading"></a></h2>
<p>Code snippets are from the following two pull requests:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/E3SM-Project/zppy/pull/34">Diurnal Cycle</a></p></li>
<li><p><a class="reference external" href="https://github.com/E3SM-Project/zppy/pull/126/files">Streamflow</a></p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Code blocks in this guide are taken from these pull requests.
They may be outdated because of more recent changes.
For example, <code class="docutils literal notranslate"><span class="pre">/lcrc/group/e3sm/public_html/diagnostics/observations/Atm/</span></code>
has replaced <code class="docutils literal notranslate"><span class="pre">/lcrc/group/e3sm/public_html/e3sm_diags_test_data/unit_test_complete_run/obs/</span></code>.</p>
</div>
</div>
<div class="section" id="handle-dependencies">
<h2>Handle dependencies<a class="headerlink" href="#handle-dependencies" title="Permalink to this heading"></a></h2>
<p>Sometimes a new set may require first editing the <code class="docutils literal notranslate"><span class="pre">climo</span></code> or <code class="docutils literal notranslate"><span class="pre">ts</span></code> functionality.</p>
<div class="section" id="add-dependencies-in-the-python-file">
<h3>Add dependencies in the Python file<a class="headerlink" href="#add-dependencies-in-the-python-file" title="Permalink to this heading"></a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">zppy/e3sm_diags.py</span></code></p>
<p>Diurnal Cycle: <code class="docutils literal notranslate"><span class="pre">e3sm_diags</span></code> had to be set up to depend on a new climatology subtask:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s2">&quot;diurnal_cycle&quot;</span> <span class="ow">in</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;sets&#39;</span><span class="p">]:</span>
    <span class="n">dependencies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">scriptDir</span><span class="p">,</span> <span class="s1">&#39;climo_</span><span class="si">%s</span><span class="s1">_</span><span class="si">%04d</span><span class="s1">-</span><span class="si">%04d</span><span class="s1">.status&#39;</span> <span class="o">%</span> <span class="p">(</span>
        <span class="n">c</span><span class="p">[</span><span class="s1">&#39;climo_diurnal_subsection&#39;</span><span class="p">],</span> <span class="n">c</span><span class="p">[</span><span class="s1">&#39;year1&#39;</span><span class="p">],</span><span class="n">c</span><span class="p">[</span><span class="s1">&#39;year2&#39;</span><span class="p">])))</span>
</pre></div>
</div>
</div></blockquote>
<p>Streamflow: <code class="docutils literal notranslate"><span class="pre">e3sm_diags</span></code> had to be set up to depend on a new time series subtask:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="s2">&quot;streamflow&quot;</span> <span class="ow">in</span> <span class="n">c</span><span class="p">[</span><span class="s2">&quot;sets&quot;</span><span class="p">]:</span>
    <span class="n">dependencies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
        <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">scriptDir</span><span class="p">,</span>
            <span class="s2">&quot;ts_rof_monthly_</span><span class="si">%04d</span><span class="s2">-</span><span class="si">%04d</span><span class="s2">-</span><span class="si">%04d</span><span class="s2">.status&quot;</span>
            <span class="o">%</span> <span class="p">(</span><span class="n">start_yr</span><span class="p">,</span> <span class="n">end_yr</span><span class="p">,</span> <span class="n">c</span><span class="p">[</span><span class="s2">&quot;ts_num_years&quot;</span><span class="p">]),</span>
        <span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="update-the-climo-or-ts-bash-files">
<h3>Update the <code class="docutils literal notranslate"><span class="pre">climo</span></code> or <code class="docutils literal notranslate"><span class="pre">ts</span></code> bash files<a class="headerlink" href="#update-the-climo-or-ts-bash-files" title="Permalink to this heading"></a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">zppy/templates/climo.bash</span></code> or <code class="docutils literal notranslate"><span class="pre">zppy/templates/ts.bash</span></code></p>
<p>Diurnal Cycle: <code class="docutils literal notranslate"><span class="pre">climo.bash</span></code> needed some changes:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>{% elif frequency.startswith(&#39;monthly_diurnal&#39;) %}
{
  dest={{ output }}/post/{{ component }}/{{ grid }}/clim_{{ subsection }}/{{ &#39;%dyr&#39; % (yr_end-yr_start+1) }}
  mkdir -p ${dest}
  mv output/*.nc ${dest}
}
{%- endif %}
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="add-any-required-pre-processing-steps-to-the-bash-file">
<h3>Add any required pre-processing steps to the bash file<a class="headerlink" href="#add-any-required-pre-processing-steps-to-the-bash-file" title="Permalink to this heading"></a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">zppy/templates/e3sm_diags.bash</span></code></p>
<p>Diurnal Cycle:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>{%- if &quot;diurnal_cycle&quot; in sets %}
# Create local links to input diurnal cycle climo files
climoDir={{ output }}/post/atm/{{ grid }}/clim_{{ climo_diurnal_subsection }}/{{ &#39;%dyr&#39; % (year2-year1+1) }}
climoDirCopy=climo_{{ climo_diurnal_subsection }}
mkdir -p ${climoDirCopy}
cd ${climoDirCopy}
cp -s ${climoDir}/${case}.eam.h4_*_${Y1}??_${Y2}??_climo.nc .
cd ..
{%- endif %}
</pre></div>
</div>
</div></blockquote>
<p>Streamflow:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span>{%- if &quot;streamflow&quot; in sets %}
rofDir=&quot;{{ output }}/post/rof/native/ts/monthly/{{ ts_num_years }}yr&quot;
mkdir -p rof_links
cd rof_links
v=&quot;RIVER_DISCHARGE_OVER_LAND_LIQ&quot;
xml_name=${v}_${Y1}01_${Y2}12.xml
cdscan -x ${xml_name} ${rofDir}/${v}_*.nc
cd ..
{%- endif %}
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="update-the-tutorial">
<h3>Update the tutorial<a class="headerlink" href="#update-the-tutorial" title="Permalink to this heading"></a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">docs/source/post.mysimulation.cfg</span></code></p>
<p>Streamflow: Since the <code class="docutils literal notranslate"><span class="pre">rof_monthly</span></code> subtask of <code class="docutils literal notranslate"><span class="pre">ts</span></code> is required, it was added
to the tutorial documentation:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span> <span class="n">rof_monthly</span> <span class="p">]]</span>
<span class="n">input_subdir</span> <span class="o">=</span> <span class="s2">&quot;archive/rof/hist&quot;</span>
<span class="n">input_files</span> <span class="o">=</span> <span class="s2">&quot;mosart.h0&quot;</span>
<span class="n">frequency</span> <span class="o">=</span> <span class="s2">&quot;monthly&quot;</span>
<span class="n">mapping_file</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="nb">vars</span> <span class="o">=</span> <span class="s2">&quot;RIVER_DISCHARGE_OVER_LAND_LIQ&quot;</span>
<span class="n">extra_vars</span> <span class="o">=</span> <span class="s1">&#39;areatotal2&#39;</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="update-the-tests">
<h3>Update the tests<a class="headerlink" href="#update-the-tests" title="Permalink to this heading"></a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">tests/integration/test_*.cfg</span></code>.</p>
<p>Streamflow: the <code class="docutils literal notranslate"><span class="pre">rof_monthly</span></code> subtask of <code class="docutils literal notranslate"><span class="pre">ts</span></code> had to be included:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[</span> <span class="n">rof_monthly</span> <span class="p">]]</span>
<span class="n">input_subdir</span> <span class="o">=</span> <span class="s2">&quot;archive/rof/hist&quot;</span>
<span class="n">input_files</span> <span class="o">=</span> <span class="s2">&quot;mosart.h0&quot;</span>
<span class="n">frequency</span> <span class="o">=</span> <span class="s2">&quot;monthly&quot;</span>
<span class="n">mapping_file</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="nb">vars</span> <span class="o">=</span> <span class="s2">&quot;RIVER_DISCHARGE_OVER_LAND_LIQ&quot;</span>
<span class="n">extra_vars</span> <span class="o">=</span> <span class="s1">&#39;areatotal2&#39;</span>
</pre></div>
</div>
</div></blockquote>
<p>The expected files will have to be updated as well.</p>
</div>
</div>
<div class="section" id="add-the-new-set">
<h2>Add the new set<a class="headerlink" href="#add-the-new-set" title="Permalink to this heading"></a></h2>
<div class="section" id="add-new-set-to-defaults">
<h3>Add new set to defaults<a class="headerlink" href="#add-new-set-to-defaults" title="Permalink to this heading"></a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">zppy/templates/default.ini</span></code></p>
<p>Diurnal Cycle: <code class="docutils literal notranslate"><span class="pre">diurnal_cycle</span></code> was added:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sets</span> <span class="o">=</span> <span class="n">string_list</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s2">&quot;lat_lon&quot;</span><span class="p">,</span><span class="s2">&quot;zonal_mean_xy&quot;</span><span class="p">,</span><span class="s2">&quot;zonal_mean_2d&quot;</span><span class="p">,</span><span class="s2">&quot;polar&quot;</span><span class="p">,</span><span class="s2">&quot;cosp_histogram&quot;</span><span class="p">,</span><span class="s2">&quot;meridional_mean_2d&quot;</span><span class="p">,</span><span class="s2">&quot;enso_diags&quot;</span><span class="p">,</span><span class="s2">&quot;qbo&quot;</span><span class="p">,</span><span class="s2">&quot;area_mean_time_series&quot;</span><span class="p">,</span><span class="s2">&quot;diurnal_cycle&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div></blockquote>
<p>Streamflow: <code class="docutils literal notranslate"><span class="pre">streamflow</span></code> was added:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sets</span> <span class="o">=</span> <span class="n">string_list</span><span class="p">(</span><span class="n">default</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s2">&quot;lat_lon&quot;</span><span class="p">,</span><span class="s2">&quot;zonal_mean_xy&quot;</span><span class="p">,</span><span class="s2">&quot;zonal_mean_2d&quot;</span><span class="p">,</span><span class="s2">&quot;polar&quot;</span><span class="p">,</span><span class="s2">&quot;cosp_histogram&quot;</span><span class="p">,</span><span class="s2">&quot;meridional_mean_2d&quot;</span><span class="p">,</span><span class="s2">&quot;enso_diags&quot;</span><span class="p">,</span><span class="s2">&quot;qbo&quot;</span><span class="p">,</span><span class="s2">&quot;diurnal_cycle&quot;</span><span class="p">,</span><span class="s2">&quot;annual_cycle_zonal_mean&quot;</span><span class="p">,</span><span class="s2">&quot;streamflow&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="add-the-python-parameter-import-setup-to-the-bash-file">
<h3>Add the Python parameter import/setup to the bash file<a class="headerlink" href="#add-the-python-parameter-import-setup-to-the-bash-file" title="Permalink to this heading"></a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">zppy/templates/e3sm_diags.bash</span></code></p>
<p>Diurnal Cycle:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%-</span> <span class="k">if</span> <span class="s2">&quot;diurnal_cycle&quot;</span> <span class="ow">in</span> <span class="n">sets</span> <span class="o">%</span><span class="p">}</span>
<span class="kn">from</span> <span class="nn">acme_diags.parameter.diurnal_cycle_parameter</span> <span class="kn">import</span> <span class="n">DiurnalCycleParameter</span>
<span class="p">{</span><span class="o">%-</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%-</span> <span class="k">if</span> <span class="s2">&quot;diurnal_cycle&quot;</span> <span class="ow">in</span> <span class="n">sets</span> <span class="o">%</span><span class="p">}</span>
<span class="n">dc_param</span> <span class="o">=</span> <span class="n">DiurnalCycleParameter</span><span class="p">()</span>
<span class="n">dc_param</span><span class="o">.</span><span class="n">reference_data_path</span> <span class="o">=</span> <span class="s1">&#39;{{ dc_obs_climo }}&#39;</span>
<span class="n">dc_param</span><span class="o">.</span><span class="n">test_data_path</span> <span class="o">=</span> <span class="s1">&#39;climo_{{ climo_diurnal_subsection }}&#39;</span>
<span class="n">dc_param</span><span class="o">.</span><span class="n">test_name</span> <span class="o">=</span> <span class="n">short_name</span>
<span class="n">dc_param</span><span class="o">.</span><span class="n">short_test_name</span> <span class="o">=</span> <span class="n">short_name</span>
<span class="c1"># Plotting diurnal cycle amplitude on different scales. Default is True</span>
<span class="n">dc_param</span><span class="o">.</span><span class="n">normalize_test_amp</span> <span class="o">=</span> <span class="kc">False</span>
<span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dc_param</span><span class="p">)</span>
<span class="p">{</span><span class="o">%-</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>Streamflow:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%-</span> <span class="k">if</span> <span class="s2">&quot;streamflow&quot;</span> <span class="ow">in</span> <span class="n">sets</span> <span class="o">%</span><span class="p">}</span>
<span class="kn">from</span> <span class="nn">e3sm_diags.parameter.streamflow_parameter</span> <span class="kn">import</span> <span class="n">StreamflowParameter</span>
<span class="p">{</span><span class="o">%-</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="o">%-</span> <span class="k">if</span> <span class="s2">&quot;streamflow&quot;</span> <span class="ow">in</span> <span class="n">sets</span> <span class="o">%</span><span class="p">}</span>
<span class="n">streamflow_param</span> <span class="o">=</span> <span class="n">StreamflowParameter</span><span class="p">()</span>
<span class="n">streamflow_param</span><span class="o">.</span><span class="n">reference_data_path</span> <span class="o">=</span> <span class="s1">&#39;{{ streamflow_obs_ts }}&#39;</span>
<span class="n">streamflow_param</span><span class="o">.</span><span class="n">test_data_path</span> <span class="o">=</span> <span class="s1">&#39;rof_links&#39;</span>
<span class="n">streamflow_param</span><span class="o">.</span><span class="n">test_name</span> <span class="o">=</span> <span class="n">short_name</span>
<span class="n">streamflow_param</span><span class="o">.</span><span class="n">test_start_yr</span> <span class="o">=</span> <span class="n">start_yr</span>
<span class="n">streamflow_param</span><span class="o">.</span><span class="n">test_end_yr</span> <span class="o">=</span> <span class="n">end_yr</span> <span class="c1"># Streamflow gauge station data range from year 1986 to 1995</span>
<span class="n">streamflow_param</span><span class="o">.</span><span class="n">ref_start_yr</span> <span class="o">=</span> <span class="s2">&quot;1986&quot;</span>
<span class="n">streamflow_param</span><span class="o">.</span><span class="n">ref_end_yr</span> <span class="o">=</span> <span class="s2">&quot;1995&quot;</span>
<span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">streamflow_param</span><span class="p">)</span>
<span class="p">{</span><span class="o">%-</span> <span class="n">endif</span> <span class="o">%</span><span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="explain-new-parameters">
<h3>Explain new parameters<a class="headerlink" href="#explain-new-parameters" title="Permalink to this heading"></a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">docs/source/parameters.rst</span></code></p>
<p>Streamflow:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Path to observation data for streamflow diagnostics</span>
<span class="n">streamflow_obs_ts</span> <span class="o">=</span> <span class="n">string</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="id1">
<h3>Update the tutorial<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">docs/source/post.mysimulation.cfg</span></code></p>
<p>Streamflow: The new parameter had to be included:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># This needs to be set for streamflow diags</span>
<span class="n">streamflow_obs_ts</span> <span class="o">=</span> <span class="s1">&#39;/lcrc/group/e3sm/public_html/e3sm_diags_test_data/unit_test_complete_run/obs/time-series/&#39;</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="id2">
<h3>Update the tests<a class="headerlink" href="#id2" title="Permalink to this heading"></a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">tests/integration/test_*.cfg</span></code>.</p>
<p>Streamflow: The new parameter had to be included:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">streamflow_obs_ts</span> <span class="o">=</span> <span class="s1">&#39;/lcrc/group/e3sm/public_html/e3sm_diags_test_data/unit_test_complete_run/obs/time-series/&#39;</span>
</pre></div>
</div>
</div></blockquote>
<p>The expected files will have to be updated as well.</p>
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tutorial_testing_e3sm_unified.html" class="btn btn-neutral float-left" title="Testing zppy for E3SM Unified release" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="new_glb_plot.html" class="btn btn-neutral float-right" title="Adding a new plot to Global Time Series" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, E3SM.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: v2.3.1
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Tags</dt>
      <dd><a href="../../v1.0.0/index.html">v1.0.0</a></dd>
      <dd><a href="../../v1.1.0/index.html">v1.1.0</a></dd>
      <dd><a href="../../v2.0.0/dev_guide/new_diags_set.html">v2.0.0</a></dd>
      <dd><a href="../../v2.1.0/dev_guide/new_diags_set.html">v2.1.0</a></dd>
      <dd><a href="../../v2.2.0/dev_guide/new_diags_set.html">v2.2.0</a></dd>
      <dd><a href="../../v2.3.0/dev_guide/new_diags_set.html">v2.3.0</a></dd>
      <dd><a href="new_diags_set.html">v2.3.1</a></dd>
    </dl>
    <dl>
      <dt>Branches</dt>
      <dd><a href="../../main/dev_guide/new_diags_set.html">main</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>