<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>How to Prepare a Release &mdash; zppy  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Testing zppy for E3SM Unified release" href="testing_e3sm_unified.html" />
    <link rel="prev" title="Testing zppy" href="testing.html" />
    <link href="../_static/style.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> zppy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">Zppy documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../schematics.html">A schematic view of zppy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parameters.html">Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../campaigns.html">Campaigns</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="project-standards.html">Project Standards</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing.html">Testing zppy</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">How to Prepare a Release</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#preparing-the-documentation">Preparing the Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bumping-the-version">Bumping the Version</a></li>
<li class="toctree-l3"><a class="reference internal" href="#releasing-on-github-release-candidates">Releasing on GitHub: release candidates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#releasing-on-github-production-releases">Releasing on GitHub: production releases</a></li>
<li class="toctree-l3"><a class="reference internal" href="#releasing-on-conda-forge-release-candidates">Releasing on conda-forge: release candidates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#releasing-on-conda-forge-production-releases">Releasing on conda-forge: production releases</a></li>
<li class="toctree-l3"><a class="reference internal" href="#creating-a-new-version-of-the-documentation">Creating a New Version of the Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="testing_e3sm_unified.html">Testing zppy for E3SM Unified release</a></li>
<li class="toctree-l2"><a class="reference internal" href="new_diags_set.html">Adding a new set to the E3SM Diagnostics task</a></li>
<li class="toctree-l2"><a class="reference internal" href="new_glb_plot.html">Adding a new plot to Global Time Series</a></li>
<li class="toctree-l2"><a class="reference internal" href="new_task.html">Adding a new task</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing to This Documentation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">zppy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Developer Guide</a> &raquo;</li>
      <li>How to Prepare a Release</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/dev_guide/release.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="how-to-prepare-a-release">
<h1>How to Prepare a Release<a class="headerlink" href="#how-to-prepare-a-release" title="Permalink to this heading"></a></h1>
<p>In this guide, we’ll cover:</p>
<ul class="simple">
<li><p>Preparing the Documentation</p></li>
<li><p>Bumping the Version</p></li>
<li><p>Releasing On GitHub</p></li>
<li><p>Releasing The Software On Anaconda</p></li>
<li><p>Creating a New Version of the Documentation</p></li>
</ul>
<div class="section" id="preparing-the-documentation">
<h2>Preparing the Documentation<a class="headerlink" href="#preparing-the-documentation" title="Permalink to this heading"></a></h2>
<ol class="arabic">
<li><p>Checkout a branch</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">fetch</span> <span class="n">upstream</span> <span class="n">main</span>
<span class="n">git</span> <span class="n">checkout</span> <span class="o">-</span><span class="n">b</span> <span class="n">versioned</span><span class="o">-</span><span class="n">docs</span> <span class="n">upstream</span><span class="o">/</span><span class="n">main</span>
</pre></div>
</div>
</li>
<li><p>Edit <code class="docutils literal notranslate"><span class="pre">docs/source/parameters.rst</span></code>: in <code class="docutils literal notranslate"><span class="pre">https://github.com/E3SM-Project/zppy/blob/main/zppy/templates/default.ini</span></code>, replace <code class="docutils literal notranslate"><span class="pre">main</span></code> with the hash of the latest commit.</p></li>
<li><p>Create a pull request to the main repo and merge it. Now, when the next version of the documentation is created (see last part of this page), it will point to the relevant defaults.</p></li>
</ol>
</div>
<div class="section" id="bumping-the-version">
<h2>Bumping the Version<a class="headerlink" href="#bumping-the-version" title="Permalink to this heading"></a></h2>
<ol class="arabic">
<li><p>Checkout the latest <code class="docutils literal notranslate"><span class="pre">main</span></code>.</p></li>
<li><p>Checkout a branch with the name of the version.</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prepend &quot;v&quot; to &lt;version&gt;</span>
<span class="c1"># For release candidates, append &quot;rc&quot; to &lt;version&gt;</span>
<span class="n">git</span> <span class="n">fetch</span> <span class="n">upstream</span> <span class="n">main</span>
<span class="n">git</span> <span class="n">checkout</span> <span class="o">-</span><span class="n">b</span> <span class="n">v</span><span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span> <span class="n">upstream</span><span class="o">/</span><span class="n">main</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Bump version using tbump.</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Exclude &quot;v&quot; and &lt;version&gt; should match step 2
# --no-tag is required since tagging is handled in &quot;Releasing on GitHub&quot;
$ tbump &lt;version&gt; --no-tag

:: Bumping from 1.0.0 to 1.1.0
=&gt; Would patch these files
- setup.py:26 version=&quot;1.0.0&quot;,
+ setup.py:26 version=&quot;1.1.0&quot;,
- zppy/__init__.py:1 __version__ = &quot;v1.0.0&quot;
+ zppy/__init__.py:1 __version__ = &quot;v1.1.0&quot;
- conda/meta.yaml:2 {% set version = &quot;1.0.0&quot; %}
+ conda/meta.yaml:2 {% set version = &quot;1.1.0&quot; %}
- tbump.toml:5 current = &quot;1.0.0&quot;
+ tbump.toml:5 current = &quot;1.1.0&quot;
=&gt; Would run these git commands
$ git add --update
$ git commit --message Bump to 1.1.0
$ git push origin v1.1.0
:: Looking good? (y/N)
&gt;
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Create a pull request to the main repo and merge it.</p></li>
</ol>
</div>
<div class="section" id="releasing-on-github-release-candidates">
<span id="github-release"></span><h2>Releasing on GitHub: release candidates<a class="headerlink" href="#releasing-on-github-release-candidates" title="Permalink to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Create a tag for the release candidate at <a class="reference external" href="https://github.com/E3SM-Project/zppy/tags">https://github.com/E3SM-Project/zppy/tags</a>.</p></li>
</ol>
</div>
<div class="section" id="releasing-on-github-production-releases">
<h2>Releasing on GitHub: production releases<a class="headerlink" href="#releasing-on-github-production-releases" title="Permalink to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Draft a new release <a class="reference external" href="https://github.com/E3SM-Project/zppy/releases">here</a>.</p></li>
<li><p>Set <cite>Tag version</cite> to <code class="docutils literal notranslate"><span class="pre">v&lt;version&gt;</span></code>, <strong>including the “v”</strong>. <cite>&#64;Target</cite> should be <code class="docutils literal notranslate"><span class="pre">main</span></code>.</p></li>
<li><p>Set <cite>Release title</cite> to <code class="docutils literal notranslate"><span class="pre">v&lt;version&gt;</span></code>, <strong>including the “v”</strong>.</p></li>
<li><p>Use <cite>Describe this release</cite> to summarize the changelog.</p>
<ul class="simple">
<li><p>You can scroll through <a class="reference external" href="https://github.com/E3SM-Project/zppy/commits/main">zppy commits</a> for a list of changes.</p></li>
</ul>
</li>
<li><p>Click <cite>Publish release</cite>.</p></li>
<li><p>CI/CD release workflow is automatically triggered.</p></li>
</ol>
</div>
<div class="section" id="releasing-on-conda-forge-release-candidates">
<h2>Releasing on conda-forge: release candidates<a class="headerlink" href="#releasing-on-conda-forge-release-candidates" title="Permalink to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Make a PR to <a class="reference external" href="https://github.com/conda-forge/zppy-feedstock/">conda-forge</a> from your fork of the feedstock. Note that the conda-forge bot does not work for release candidates.</p>
<ul class="simple">
<li><p>Start from the current dev branch and update the version number and the sha256 sum manually.</p></li>
<li><p>Set the build number back to 0 if needed.</p></li>
<li><p>Make the dev branch the target of the PR. Then, the package build on conda-forge will end up with the <code class="docutils literal notranslate"><span class="pre">e3sm_dev</span></code> label.</p></li>
</ul>
</li>
<li><p>Check the <a class="reference external" href="https://anaconda.org/conda-forge/zppy">https://anaconda.org/conda-forge/zppy</a> page to view the newly updated package. Release candidates are assigned the <code class="docutils literal notranslate"><span class="pre">e3sm_dev</span></code> label.</p></li>
</ol>
</div>
<div class="section" id="releasing-on-conda-forge-production-releases">
<h2>Releasing on conda-forge: production releases<a class="headerlink" href="#releasing-on-conda-forge-production-releases" title="Permalink to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Be sure to have already completed <a class="reference internal" href="#github-release"><span class="std std-ref">Releasing On GitHub</span></a>. This triggers the CI/CD workflow that handles Anaconda releases.</p></li>
<li><p>Wait for a bot PR to come up automatically on conda-forge after the GitHub release. This can happen anywhere from 1 hour to 1 day later.</p></li>
<li><p>Re-render the PR (see <a class="reference external" href="https://conda-forge.org/docs/maintainer/updating_pkgs.html#rerendering-feedstocks">docs</a>).</p></li>
<li><p>Merge the PR on conda-forge.</p></li>
<li><p>Check the <a class="reference external" href="https://anaconda.org/conda-forge/zppy">https://anaconda.org/conda-forge/zppy</a> page to view the newly updated package. Production releases are assigned the <code class="docutils literal notranslate"><span class="pre">main</span></code> label.</p></li>
<li><p>Notify the maintainers of the unified E3SM environment about the new release on the <a class="reference external" href="https://acme-climate.atlassian.net/wiki/spaces/WORKFLOW/pages/129732419/E3SM+Unified+Anaconda+Environment">E3SM Confluence site</a>.</p>
<ul class="simple">
<li><p>Be sure to only update the <code class="docutils literal notranslate"><span class="pre">zppy</span></code> version number in the correct version(s) of the E3SM Unified environment.</p></li>
<li><p>This is almost certainly one of the versions listed under “Next versions”. If you are uncertain of which to update, leave a comment on the page asking.</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="creating-a-new-version-of-the-documentation">
<h2>Creating a New Version of the Documentation<a class="headerlink" href="#creating-a-new-version-of-the-documentation" title="Permalink to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Be sure to have already completed <a class="reference internal" href="#github-release"><span class="std std-ref">Releasing On GitHub</span></a>. This triggers the CI/CD workflow that handles publishing documentation versions.</p></li>
<li><p>Wait until the CI/CD build is successful. You can view all workflows at <a class="reference external" href="https://github.com/E3SM-Project/zppy/actions">All Workflows</a>.</p></li>
<li><p>Changes will be available on the <a class="reference external" href="https://e3sm-project.github.io/zppy/">zppy documentation page</a>.</p></li>
</ol>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="testing.html" class="btn btn-neutral float-left" title="Testing zppy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="testing_e3sm_unified.html" class="btn btn-neutral float-right" title="Testing zppy for E3SM Unified release" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, E3SM.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book"> Other Versions</span>
    v: main
    <span class="fa fa-caret-down"></span>
  </span>
  <div class="rst-other-versions">
    <dl>
      <dt>Tags</dt>
      <dd><a href="../../v1.0.0/dev_guide/release.html">v1.0.0</a></dd>
      <dd><a href="../../v1.1.0/dev_guide/release.html">v1.1.0</a></dd>
      <dd><a href="../../v2.0.0/dev_guide/release.html">v2.0.0</a></dd>
      <dd><a href="../../v2.1.0/dev_guide/release.html">v2.1.0</a></dd>
      <dd><a href="../../v2.2.0/dev_guide/release.html">v2.2.0</a></dd>
    </dl>
    <dl>
      <dt>Branches</dt>
      <dd><a href="release.html">main</a></dd>
    </dl>
  </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>